var app=angular.module("app",["angular-loading-bar","ui.router","ui.bootstrap","ui.sortable"]);app.config(["$stateProvider","$urlRouterProvider",function(t,r){r.otherwise("/adItem"),t.state("adItem",{url:"/adItem",templateUrl:"app/components/adItem/adItem.html",controller:"adItemController",controllerAs:"adItemCtrl"})}]);

var AdItemController=function(o){this.adItemService=o};AdItemController.prototype.display=function(o){var t=this;t.adItemService.Crawl().sendData(o).then(function(o){t.show=!0,t.links=o.links,t.address=o.propertyInfo.address,t.bedRoom=o.propertyInfo.no_bed,t.bathRoom=o.propertyInfo.no_bath,t.carport=o.propertyInfo.no_car}),t.sortableOptions={stop:function(o,e){var n=t.links.map(function(o){return o}).join(",\n");console.log("Stop: \n"+n)},items:".adItemRow:not(.not-sortable)"}},angular.module("app").controller("adItemController",["adItemService",AdItemController]);
var AdItemDirective=function(t){function e(e,a,r){function o(t,e,a,r,o){l.drawImage(t,e,a,r,o)}console.log(t.Crawl().getData()),a.find("canvas").bind("mouseenter",function(){}),a.find("canvas").bind("mouseleave",function(){a.find("canvas").css("opacity","1")});var n=a.find("canvas")[0],l=n.getContext("2d"),i=[t.Crawl().getData().links[e.out]];0==e.out&&(i.push(t.Crawl().getData().templateDirWeb.Banner),i.push(t.Crawl().getData().templateDirWeb.Bottom),i.push(t.Crawl().getData().templateDirWeb.Bed),i.push(t.Crawl().getData().templateDirWeb.Bath),i.push(t.Crawl().getData().templateDirWeb.Car),i.push(t.Crawl().getData().templateDirWeb.Logo));for(var p=[],f=0;f<i.length;f++){var c=new Image;c.src=i[f],p.push(c),c.onload=function(){o(p[0],0,0,400,300),o(p[1],0,0,200,191),o(p[2],0,267,400,33),o(p[3],29,267,67,32),o(p[4],153,267,67,32),o(p[5],276,267,67,32),o(p[6],247,5,148,34);var e="20pt ",a=t.Crawl().getData().propertyInfo.agency_localDir;l.font=e+a,l.textBaseline="bottom",l.fillStyle="#000000",l.fillText(t.Crawl().getData().propertyInfo.no_bed,97,300),l.fillText(t.Crawl().getData().propertyInfo.no_bath,220,300),l.fillText(t.Crawl().getData().propertyInfo.no_car,343,300),l.save(),l.rotate(-.76),l.fillStyle="#ffffff",e="21pt ",l.font=e+a,l.fillText("Auction this",-72,96),e="19pt ",l.font=e+a,l.fillText(t.Crawl().getData().propertyInfo.auction_day+" "+t.Crawl().getData().propertyInfo.auction_hour,-94,121),l.restore()}}}var a={restrict:"AE",templateUrl:"app/components/adItem/adItemDirective.html",link:e,scope:{out:"@",model:"=",remove:"&"}};return a};angular.module("app").directive("adItem",["adItemService",AdItemDirective]);
var AdItemService=function(e,t){this.$http=e,this.$q=t};AdItemService.prototype.Crawl=function(){var e=this,t={sendData:function(t){var r={url:t},p=e.$q.defer(),i=e.$http.post("api/crawl",r);return i.success(function(t){e.links=t.links,e.propertyInfo=t.propertyInfo,e.templateDirWeb=t.templateDirWeb,p.resolve({links:t.links,propertyInfo:t.propertyInfo,templateDirWeb:t.templateDirWeb})}),p.promise},getData:function(){var t={links:e.links,propertyInfo:e.propertyInfo,templateDirWeb:e.templateDirWeb};return t}};return t},angular.module("app").service("adItemService",["$http","$q",AdItemService]);