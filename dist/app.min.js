var app=angular.module("app",["angular-loading-bar","ui.router","ui.bootstrap","ui.sortable"]);app.config(["$stateProvider","$urlRouterProvider",function(t,r){r.otherwise("/adItem"),t.state("adItem",{url:"/adItem",templateUrl:"app/components/adItem/adItem.html",controller:"adItemController",controllerAs:"adItemCtrl"})}]);

var AdItemController=function(o){this.adItemService=o};AdItemController.prototype.display=function(o){var t=this;t.adItemService.Crawl().sendData(o).then(function(o){t.show=!0,t.links=o.links,t.address=o.propertyInfo.address,t.bedRoom=o.propertyInfo.no_bed,t.bathRoom=o.propertyInfo.no_bath,t.carport=o.propertyInfo.no_car}),t.sortableOptions={stop:function(o,e){var n=t.links.map(function(o){return o}).join(",\n");console.log("Stop: \n"+n)},items:".adItemRow:not(.not-sortable)"}},angular.module("app").controller("adItemController",["adItemService",AdItemController]);
var AdItemDirective=function(e){function a(a,t,n){console.log(e.Crawl().getData()),t.find("canvas").bind("mouseenter",function(){}),t.find("canvas").bind("mouseleave",function(){t.find("canvas").css("opacity","1")});var r=t.find("canvas")[0],o=r.getContext("2d");o.globalCompositeOperation="source-over";var i=[e.Crawl().getData().links[a.out]];0==a.out&&i.push(e.Crawl().getData().templateDirWeb.Banner);for(var c=[],l=0,d=0;d<i.length;d++){var m=new Image;m.src=i[d],c.push(m),m.onload=function(){++l==i.length&&(o.drawImage(c[0],0,0,80,60),i.length>1&&o.drawImage(c[1],0,0,40.4,37.4))}}}var t={restrict:"AE",templateUrl:"app/components/adItem/adItemDirective.html",link:a,scope:{out:"@",model:"=",remove:"&"}};return t};angular.module("app").directive("adItem",["adItemService",AdItemDirective]);
var AdItemService=function(e,t){this.$http=e,this.$q=t};AdItemService.prototype.Crawl=function(){var e=this,t={sendData:function(t){var r={url:t},p=e.$q.defer(),i=e.$http.post("api/crawl",r);return i.success(function(t){e.links=t.links,e.propertyInfo=t.propertyInfo,e.templateDirWeb=t.templateDirWeb,p.resolve({links:t.links,propertyInfo:t.propertyInfo,templateDirWeb:t.templateDirWeb})}),p.promise},getData:function(){var t={links:e.links,propertyInfo:e.propertyInfo,templateDirWeb:e.templateDirWeb};return t}};return t},angular.module("app").service("adItemService",["$http","$q",AdItemService]);