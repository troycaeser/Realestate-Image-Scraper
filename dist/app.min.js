var app=angular.module("app",["angular-loading-bar","ui.router","ui.bootstrap","ui.sortable"]);app.config(["$stateProvider","$urlRouterProvider",function(t,r){r.otherwise("/adItem"),t.state("adItem",{url:"/adItem",templateUrl:"app/components/adItem/adItem.html",controller:"adItemController",controllerAs:"adItemCtrl"})}]);

var AdItemController=function(o){this.adItemService=o,this.test=!0};AdItemController.prototype.display=function(o){var t=this;t.adItemService.Crawl().sendData(o).then(function(o){t.show=!0,t.links=o.links,t.address=o.propertyInfo.address,t.bedRoom=o.propertyInfo.no_bed,t.bathRoom=o.propertyInfo.no_bath,t.carport=o.propertyInfo.no_car}),t.sortableOptions={stop:function(o,e){var n=t.links.map(function(o){return o}).join(",\n");console.log("Stop: \n"+n)},items:".adItemRow:not(.not-sortable)"}},angular.module("app").controller("adItemController",["adItemService",AdItemController]);
var AdItemDirective=function(t){function a(a,e,n){function o(e,n){if(console.log(a.out),0==a.out){var o=t.Crawl().getData(),r=new Image;r.onload=function(){l.drawImage(r,300,o.myWallet.main.Logo.pos_y)},l.save(),"true"==e?(r.src=o.templateDirWeb.Logo,l.translate(-100,0),l.restore()):"true"==n&&l.translate(100,0)}}var r=e.find("canvas")[0],l=r.getContext("2d");a.$watch("logo",function(t,a,e){o(t,a)},!1)}function e(a,e,n){function o(t,a,e,n,o){i.drawImage(t,a,e,n,o)}function r(){o(s[1],0,0,s[1].naturalWidth,s[1].naturalHeight),o(s[2],0,267,s[2].naturalWidth,s[2].naturalHeight+2),o(s[3],m.myWallet.main.Bed.pos_x,m.myWallet.main.Bed.pos_y,s[3].naturalWidth,s[3].naturalHeight),o(s[4],m.myWallet.main.Bath.pos_x,m.myWallet.main.Bath.pos_y,s[4].naturalWidth,s[4].naturalHeight),o(s[5],m.myWallet.main.Car.pos_x,m.myWallet.main.Car.pos_y,s[5].naturalWidth,s[5].naturalHeight),i.save();var t=m.myWallet.main.Text.font_size+"pt ",a=m.propertyInfo.agency_localDir;i.font=t+a,i.textBaseline="alphabetic";var e=m.myWallet.main.Text;i.fillStyle="rgb("+e.colour_r+","+e.colour_g+","+e.colour_b+")",i.fillText(m.propertyInfo.no_bed,m.myWallet.main.Bed.t_pos_x,m.myWallet.main.Bed.t_pos_y),i.fillText(m.propertyInfo.no_bath,m.myWallet.main.Bath.t_pos_x,m.myWallet.main.Bath.t_pos_y),i.fillText(m.propertyInfo.no_car,m.myWallet.main.Car.t_pos_x,m.myWallet.main.Car.t_pos_y);var n=m.myWallet.main.Banner.A.top.t_pos_x,r=m.myWallet.main.Banner.A.top.t_pos_y,l=Math.sqrt(n*n+r*r),u=Math.acos(r/l),p=.76-u;-l*Math.cos(p),l*Math.sin(p);i.translate(n,r),i.rotate(-.76),i.translate(-n,-r),i.fillStyle="rgb("+e.colour_banner_r+","+e.colour_banner_g+","+e.colour_banner_b+")",t=m.myWallet.main.Banner.A.top.font_size+"pt ",i.font=t+a,i.fillText("Auction this",n,r),i.restore(),i.save(),i.fillStyle="rgb("+e.colour_banner_r+","+e.colour_banner_g+","+e.colour_banner_b+")";var c=m.propertyInfo.auction_hour.length,_=m.myWallet.main.Banner.A.bottom.Saturday[c].t_pos_x,y=m.myWallet.main.Banner.A.bottom.Saturday[c].t_pos_y;i.translate(_,y),i.rotate(-.76),i.translate(-_,-y),t=m.myWallet.main.Banner.A.bottom.Saturday[c].font_size+"pt ",i.font=t+a,i.fillText(m.propertyInfo.auction_day+" "+m.propertyInfo.auction_hour,_,y),i.restore()}console.log(n),e.find("canvas").bind("mouseenter",function(){}),e.find("canvas").bind("mouseleave",function(){e.find("canvas").css("opacity","1")});var l=e.find("canvas")[0],i=l.getContext("2d"),m=t.Crawl().getData();console.log(m);var u=[m.links[a.out]];0==a.out&&(u.push(m.templateDirWeb.Banner),u.push(m.templateDirWeb.Bottom),u.push(m.templateDirWeb.Bed),u.push(m.templateDirWeb.Bath),u.push(m.templateDirWeb.Car));for(var s=[],p=0;p<u.length;p++){var c=new Image;c.src=u[p],s.push(c),c.onload=function(){a.out>0?o(s[0],0,0,s[0].naturalWidth,s[0].naturalHeight):(o(s[0],0,0,s[0].naturalWidth,s[0].naturalHeight-30),r())}}}var n={restrict:"AE",templateUrl:"app/components/adItem/adItemDirective.html",compile:function(){return{pre:a,post:e}},scope:{out:"@",model:"=",remove:"&",logo:"@",stuff:"="}};return n};angular.module("app").directive("adItem",["adItemService",AdItemDirective]);
var AdItemService=function(e,t){this.$http=e,this.$q=t};AdItemService.prototype.Crawl=function(){var e=this,t={sendData:function(t){var r={url:t},l=e.$q.defer(),p=e.$http.post("api/crawl",r);return p.success(function(t){e.links=t.links,e.propertyInfo=t.propertyInfo,e.templateDirWeb=t.templateDirWeb,e.myWallet=t.myWallet,l.resolve({links:t.links,propertyInfo:t.propertyInfo,templateDirWeb:t.templateDirWeb,myWallet:t.myWallet})}),l.promise},getData:function(){var t={links:e.links,propertyInfo:e.propertyInfo,templateDirWeb:e.templateDirWeb,myWallet:e.myWallet};return t}};return t},angular.module("app").service("adItemService",["$http","$q",AdItemService]);