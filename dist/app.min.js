var app=angular.module("app",["angular-loading-bar","ui.router","ui.bootstrap","ui.sortable"]);app.config(["$stateProvider","$urlRouterProvider",function(t,r){r.otherwise("/adItem"),t.state("adItem",{url:"/adItem",templateUrl:"app/components/adItem/adItem.html",controller:"adItemController",controllerAs:"adItemCtrl"})}]);

var AdItemController=function(o){this.adItemService=o};AdItemController.prototype.display=function(o){var e=this;e.adItemService.Crawl().sendData(o).then(function(o){e.show=!0,e.links=o.links,e.address=o.propertyInfo.address,e.bedRoom=o.propertyInfo.no_bed,e.bathRoom=o.propertyInfo.no_bath,e.carport=o.propertyInfo.no_car}),e.sortableOptions={stop:function(o,t){var n=e.links.map(function(o){return o});e.adItemService.Crawl().sendLinks(n),console.info("Reordered list of image links:\n"+n.join("\n"))},items:".adItemRow:not(.not-sortable)"},e.submit=function(){var o=e.adItemService.Crawl().getData(),t={links:this.links,propertyInfo:o.propertyInfo,templateDirWeb:o.templateDirWeb,templateInfo:o.templateInfo};t.propertyInfo.no_bed=e.bedRoom,t.propertyInfo.no_bath=e.bathRoom,t.propertyInfo.no_car=e.carport,e.adItemService.Crawl().sendFinal(t),console.info("final data sent:\n"),console.info(t)}},angular.module("app").controller("adItemController",["adItemService",AdItemController]);
var AdItemDirective=function(t){function e(e,n){var o=this,a=t.Crawl().getData(),i=a.links,r=a.propertyInfo,l=a.templateDirWeb,_=a.templateInfo,s=r.auction_hour,m=r.auction_day;o.values=[],o.photo={src:i[e.index],"class":"adItemPhotos"},o.values.push(o.photo),o.banner={src:l.Banner,"class":"adItemBanner"},o.bottom={src:l.Bottom,"class":"adItemBottom"},o.logo={src:l.Logo,"class":"adItemLogo"},o.bed={src:l.Bed,"class":"adItemBed",text:{text:r.no_bed}},o.bath={src:l.Bath,"class":"adItemBath",text:{text:r.no_bath}},o.car={src:l.Car,"class":"adItemCar",text:{text:r.no_car}},o.bannerText={firstLine:{text:"Auction this"},secondLine:{text:r.auction_day+" "+r.auction_hour}},0==e.index?(o.bannerText.firstLine.style={"font-family":r.agency_localDir,"font-size":_.main.Banner.A.top.font_size+"pt",left:_.main.Banner.A.top.t_pos_x,top:_.main.Banner.A.top.t_pos_y,"margin-left":-_.main.Banner.A.top.font_size,"margin-top":-_.main.Banner.A.top.font_size,color:"rgb("+_.main.Text.colour_banner_r+","+_.main.Text.colour_banner_g+","+_.main.Text.colour_banner_b+")","webkit-transform-origin":"left top","-webkit-transform":"rotate(-"+_.main.Banner.angle+"deg)"},o.bannerText.secondLine.style={"font-family":r.agency_localDir,"font-size":_.main.Banner.A.bottom[m][s.length].font_size+"pt",left:_.main.Banner.A.bottom[m][s.length].t_pos_x,top:_.main.Banner.A.bottom[m][s.length].t_pos_y,"margin-left":-_.main.Banner.A.bottom[m][s.length].font_size,"margin-top":-_.main.Banner.A.bottom[m][s.length].font_size,color:"rgb("+_.main.Text.colour_banner_r+","+_.main.Text.colour_banner_g+","+_.main.Text.colour_banner_b+")","webkit-transform-origin":"left top","-webkit-transform":"rotate(-"+_.main.Banner.angle+"deg)"},o.logo.style={left:_.main.Logo.pos_x,top:_.main.Logo.pos_y},o.bed.style={left:_.main.Bed.pos_x,top:_.main.Bed.pos_y},o.bath.style={left:_.main.Bath.pos_x,top:_.main.Bath.pos_y},o.car.style={left:_.main.Car.pos_x,top:_.main.Car.pos_y},o.values.push(o.banner),o.values.push(o.bottom),o.values.push(o.logo),o.values.push(o.bannerText),o.values.push(o.bed),o.values.push(o.bath),"N/A"!=r.no_car?(o.bed.text.style={"font-family":r.agency_localDir,"font-size":_.main.Text.font_size+"pt",left:_.main.Bed.t_pos_x,top:_.main.Bed.t_pos_y-_.main.Text.font_size+"px","line-height":_.main.Text.font_size+"px",color:"rgb("+_.main.Text.colour_banner_r+","+_.main.Text.colour_banner_g+","+_.main.Text.colour_banner_b+")"},o.bath.text.style={"font-family":r.agency_localDir,"font-size":_.main.Text.font_size+"pt",left:_.main.Bath.t_pos_x,top:_.main.Bath.t_pos_y-_.main.Text.font_size+"px","line-height":_.main.Text.font_size+"px",color:"rgb("+_.main.Text.colour_banner_r+","+_.main.Text.colour_banner_g+","+_.main.Text.colour_banner_b+")"},o.car.text.style={"font-family":r.agency_localDir,"font-size":_.main.Text.font_size+"pt",left:_.main.Car.t_pos_x,top:_.main.Car.t_pos_y-_.main.Text.font_size+"px","line-height":_.main.Text.font_size+"px",color:"rgb("+_.main.Text.colour_banner_r+","+_.main.Text.colour_banner_g+","+_.main.Text.colour_banner_b+")"},o.values.push(o.car)):"N/A"==r.no_car&&(o.bed.text.style={"font-family":r.agency_localDir,"font-size":_.main.Text.font_size+"pt",left:_.main.Bed.t_pos_x_2,top:_.main.Bed.t_pos_y_2-_.main.Text.font_size+"px","line-height":_.main.Text.font_size+"px",color:"rgb("+_.main.Text.colour_banner_r+","+_.main.Text.colour_banner_g+","+_.main.Text.colour_banner_b+")"},o.bath.text.style={"font-family":r.agency_localDir,"font-size":_.main.Text.font_size+"pt",left:_.main.Bath.t_pos_x_2,top:_.main.Bath.t_pos_y_2-_.main.Text.font_size+"px","line-height":_.main.Text.font_size+"px",color:"rgb("+_.main.Text.colour_banner_r+","+_.main.Text.colour_banner_g+","+_.main.Text.colour_banner_b+")"},o.car.text.style={"font-family":r.agency_localDir,"font-size":_.main.Text.font_size+"pt",left:_.main.Car.t_pos_x_2,top:_.main.Car.t_pos_y_2-_.main.Text.font_size+"px","line-height":_.main.Text.font_size+"px",color:"rgb("+_.main.Text.colour_banner_r+","+_.main.Text.colour_banner_g+","+_.main.Text.colour_banner_b+")"})):(o.logo.style={left:_.other.Logo.pos_x,top:_.other.Logo.pos_y},o.values.push(o.logo))}function n(t,e,n){e.find("img.adItemLogo").css({"background-color":"red"})}function o(t,e,n){}var a={restrict:"AE",templateUrl:"app/components/adItem/adItemDirective.html",compile:function(){return{pre:o,post:n}},controller:e,controllerAs:"adItem",scope:{index:"@",model:"=",remove:"&"}};return a};angular.module("app").directive("adItem",["adItemService",AdItemDirective]);
var AdItemService=function(e,t){this.$http=e,this.$q=t};AdItemService.prototype.Crawl=function(){var e=this,t={sendData:function(t){var n={url:t},r=e.$q.defer(),i=e.$http.post("api/crawl",n);return i.success(function(t){e.links=t.links,e.propertyInfo=t.propertyInfo,e.templateDirWeb=t.templateDirWeb,e.templateInfo=t.templateInfo,r.resolve({links:t.links,propertyInfo:t.propertyInfo,templateDirWeb:t.templateDirWeb,templateInfo:t.templateInfo})}),r.promise},getData:function(){var t={links:e.links,propertyInfo:e.propertyInfo,templateDirWeb:e.templateDirWeb,templateInfo:e.templateInfo};return t},sendLinks:function(t){return e.newlinks=t,e.newLinks},getLinks:function(){var t=e.newlinks;return t},sendFinal:function(t){e.$http.post("api/sendFinal",t)}};return t},angular.module("app").service("adItemService",["$http","$q",AdItemService]);